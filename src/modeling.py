import pandas as pdimport numpy as npfrom pathlib import Pathfrom sklearn.model_selection import train_test_splitfrom sklearn.ensemble import RandomForestRegressor, RandomForestClassifierimport joblibDATA_DIR = Path("data")MODELS_DIR = Path("models")MODELS_DIR.mkdir(exist_ok=True)def train_models():    # load dataset    df = pd.read_csv(DATA_DIR / "processed" / "processed_movies.csv")    # Used features    features = ["log_budget", "popularity", "vote_average", "runtime"]    X = df[features]    # -----------------------------    # Model 1 : Regression (log_revenue)    # -----------------------------    y_reg = df["log_revenue"]    X_train, X_test, y_train, y_test = train_test_split(        X, y_reg, test_size=0.2, random_state=42    )    reg_model = RandomForestRegressor(        n_estimators=300,        random_state=42    )    reg_model.fit(X_train, y_train)    joblib.dump(reg_model, MODELS_DIR / "revenue_model.joblib")    print("✔️ Modèle de régression sauvegardé")    # -----------------------------    # Model 2 : Classification (hit)    # -----------------------------    y_clf = df["hit"]    clf_model = RandomForestClassifier(        n_estimators=300,        random_state=42    )    clf_model.fit(X_train, y_clf.loc[X_train.index])    joblib.dump(clf_model, MODELS_DIR / "hit_model.joblib")    print("✔️ Modèle de classification sauvegardé")if __name__ == "__main__":    train_models()